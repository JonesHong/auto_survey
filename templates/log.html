<!-- log.html -->
<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>系統日誌查看器</title>
    <link rel="stylesheet" href="{{ root_path }}/static/css/log.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Noto+Sans+TC:wght@400;500;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="log-container">
        <!-- 日誌工具欄 -->
        <div class="log-toolbar">
            <div class="toolbar-left">
                <h2>📋 系統日誌</h2>
                <div class="log-info">
                    <span id="log-status">載入中...</span>
                    <span id="log-size">-</span>
                    <span id="log-lines">-</span>
                </div>
            </div>
            <div class="toolbar-right">
                <div class="control-group">
                    <label for="tail-input">最後:</label>
                    <input type="number" id="tail-input" value="50" min="1" max="1000">
                    <span>行</span>
                </div>
                <div class="search-group">
                    <input type="text" id="search-input" placeholder="搜尋日誌..." maxlength="100">
                    <button id="search-btn" class="btn btn-secondary">🔍</button>
                    <button id="clear-search-btn" class="btn btn-secondary" style="display: none;">✕</button>
                </div>
                <button id="refresh-btn" class="btn btn-secondary">🔄 重新載入</button>
                <button id="clear-btn" class="btn btn-secondary">🗑️ 清空</button>
                <button id="export-btn" class="btn btn-secondary">📥 匯出</button>
                <button id="realtime-btn" class="btn btn-primary">📡 即時監控</button>
            </div>
        </div>

        <!-- 日誌內容區域 -->
        <div class="log-content">
            <div class="log-header">
                <div class="timestamp-col">時間</div>
                <div class="level-col">級別</div>
                <div class="source-col">來源</div>
                <div class="message-col">訊息</div>
            </div>
            <div class="log-body" id="log-body">
                <div class="log-loading">
                    <div class="loading-spinner"></div>
                    <span>載入日誌中...</span>
                </div>
            </div>
        </div>

        <!-- 底部狀態欄 -->
        <div class="log-footer">
            <div class="footer-left">
                <span id="connection-status">🔴 離線</span>
                <span id="last-update">最後更新: -</span>
            </div>
            <div class="footer-right">
                <button id="scroll-to-bottom" class="btn btn-small">⬇️ 滾動到底部</button>
                <button id="auto-scroll-toggle" class="btn btn-small active">🔄 自動滾動</button>
            </div>
        </div>
    </div>

    <!-- 將 root_path 傳遞給 JavaScript -->
    <script>
        window.ROOT_PATH = "{{ root_path }}";
    </script>
    <script src="{{ root_path }}/static/js/log.js"></script>
</body>

</html>